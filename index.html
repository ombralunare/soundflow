<!DOCTYPE html>
<html>
    <head>
        <script>
            function sendit()
            {
                let txt = document.getElementById("targetUrl").value;
                let xhr = new XMLHttpRequest();  xhr.open("POST","/?v=1.0.0");

                xhr.onloadstart = function()
                {
                    let btn = document.getElementById("grab");
                    btn.style.display = "none";
                    let mtr = document.createElement("meter");
                    mtr.setAttribute("id", "busy");
                    mtr.setAttribute("min", 0);
                    mtr.setAttribute("max", 100);
                    mtr.value = 0;
                    document.body.appendChild(mtr);

                };

                xhr.onprogress = function(event)
                {
                    let prc = ((event.loaded / event.total) *100);
                    prc = (prc.toFixed(2)*1);
                    document.getElementById("busy").value = prc;
                    // console.log(prc);
                };

                xhr.onloadend = function()
                {
                    console.log("done");

                    let pop = document.createElement("div");
                    div.innerHTML = `
                                        <a href="/song.zip" download >download</a>
                                    `;
                    document.body.appendChild(pop);
                };

                xhr.send(txt);
            };
        </script>
    </head>
    <body>
        <input id="targetUrl" type="text">
        <br>
        <input id="grab" type="button" value="download" onclick="sendit()">
    </body>
</html>
